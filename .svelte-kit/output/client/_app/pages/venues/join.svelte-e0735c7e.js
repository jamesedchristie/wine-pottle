import{S as n,i as t,s as e,j as s,m as o,o as r,v as a,r as i,w as c,e as u,t as f,k as d,c as l,a as p,g as h,d as v,n as $,b as m,f as y,E as w,T as g,O as j,h as b,u as x,H as k,B as E,V as I}from"../../chunks/vendor-494dde6f.js";import{B as P}from"../../chunks/Button-fbe70615.js";import{E as S}from"../../chunks/ErrorAlert-7d139505.js";import{s as B}from"../../chunks/stores-3eb657b5.js";import{g as T}from"../../chunks/navigation-20968cc5.js";import"../../chunks/singletons-bb9012b7.js";function V(n){let t,e;return t=new S({props:{$$slots:{default:[N]},$$scope:{ctx:n}}}),{c(){s(t.$$.fragment)},l(n){o(t.$$.fragment,n)},m(n,s){r(t,n,s),e=!0},p(n,e){const s={};130&e&&(s.$$scope={dirty:e,ctx:n}),t.$set(s)},i(n){e||(a(t.$$.fragment,n),e=!0)},o(n){i(t.$$.fragment,n),e=!1},d(n){c(t,n)}}}function N(n){let t;return{c(){t=f(n[1])},l(e){t=h(e,n[1])},m(n,e){y(n,t,e)},p(n,e){2&e&&b(t,n[1])},d(n){n&&v(t)}}}function O(n){let t;return{c(){t=f("Submit")},l(n){t=h(n,"Submit")},m(n,e){y(n,t,e)},d(n){n&&v(t)}}}function A(n){let t,e,k,I,S,B,T,N,A,C,H,L,_,q,D,J=n[0].name+"",U=n[1]&&V(n);return L=new P({props:{variant:"primary",$$slots:{default:[O]},$$scope:{ctx:n}}}),L.$on("click",n[3]),{c(){t=u("h1"),e=f(J),k=d(),I=u("section"),U&&U.c(),S=d(),B=u("div"),T=u("label"),N=f("Venue Password"),A=d(),C=u("input"),H=d(),s(L.$$.fragment),this.h()},l(n){t=l(n,"H1",{});var s=p(t);e=h(s,J),s.forEach(v),k=$(n),I=l(n,"SECTION",{});var r=p(I);U&&U.l(r),S=$(r),B=l(r,"DIV",{});var a=p(B);T=l(a,"LABEL",{for:!0});var i=p(T);N=h(i,"Venue Password"),i.forEach(v),A=$(a),C=l(a,"INPUT",{id:!0,type:!0}),H=$(a),o(L.$$.fragment,a),a.forEach(v),r.forEach(v),this.h()},h(){m(T,"for","passwordInput"),m(C,"id","passwordInput"),m(C,"type","password")},m(s,o){y(s,t,o),w(t,e),y(s,k,o),y(s,I,o),U&&U.m(I,null),w(I,S),w(I,B),w(B,T),w(T,N),w(B,A),w(B,C),g(C,n[2]),w(B,H),r(L,B,null),_=!0,q||(D=j(C,"input",n[4]),q=!0)},p(n,[t]){(!_||1&t)&&J!==(J=n[0].name+"")&&b(e,J),n[1]?U?(U.p(n,t),2&t&&a(U,1)):(U=V(n),U.c(),a(U,1),U.m(I,S)):U&&(E(),i(U,1,1,(()=>{U=null})),x()),4&t&&C.value!==n[2]&&g(C,n[2]);const s={};128&t&&(s.$$scope={dirty:t,ctx:n}),L.$set(s)},i(n){_||(a(U),a(L.$$.fragment,n),_=!0)},o(n){i(U),i(L.$$.fragment,n),_=!1},d(n){n&&v(t),n&&v(k),n&&v(I),U&&U.d(),c(L),q=!1,D()}}}var C=function(n,t,e,s){return new(e||(e=Promise))((function(o,r){function a(n){try{c(s.next(n))}catch(t){r(t)}}function i(n){try{c(s.throw(n))}catch(t){r(t)}}function c(n){var t;n.done?o(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(a,i)}c((s=s.apply(n,t||[])).next())}))};const H=({page:n,fetch:t})=>C(void 0,void 0,void 0,(function*(){const e=yield t(`/venues/${n.query.get("venue")}.json`);return{props:{venue:(yield e.json()).venue}}}));function L(n,t,e){let s;k(n,B,(n=>e(5,s=n)));var o=this&&this.__awaiter||function(n,t,e,s){return new(e||(e=Promise))((function(o,r){function a(n){try{c(s.next(n))}catch(t){r(t)}}function i(n){try{c(s.throw(n))}catch(t){r(t)}}function c(n){var t;n.done?o(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(a,i)}c((s=s.apply(n,t||[])).next())}))};let r="",{venue:a}=t,i="";return n.$$set=n=>{"venue"in n&&e(0,a=n.venue)},[a,r,i,function(){return o(this,void 0,void 0,(function*(){try{const n=yield fetch("/venues/join",{method:"post",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:i,venueId:a.id,userId:s.user.id})});if(!n.ok){throw(yield n.json()).errors}I(B,s.venue=a,s),yield T(`${a.route}`)}catch(n){e(1,r=n)}}))},function(){i=this.value,e(2,i)}]}export default class extends n{constructor(n){super(),t(this,n,L,A,e,{venue:0})}}export{H as load};
