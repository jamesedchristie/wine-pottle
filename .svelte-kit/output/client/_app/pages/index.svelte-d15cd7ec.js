import{S as e,i as n,s as t,j as r,m as s,o as l,H as o,v as u,r as a,w as h,e as c,t as i,k as f,l as v,c as d,a as m,g as p,d as g,n as E,b as $,f as V,D as y,h as A,G as j,N as I}from"../chunks/vendor-197173f7.js";import{E as w}from"../chunks/ErrorAlert-f76ade2a.js";import{s as P}from"../chunks/stores-23449eec.js";/* empty css                                                         */function k(e,n,t){const r=e.slice();return r[6]=n[t],r}function x(e,n,t){const r=e.slice();return r[6]=n[t],r}function C(e){let n,t,r,s,l,o,u,a,h,j,w=e[0].user.name+"",P=e[2].length>0&&function(e){let n,t,r,s,l=e[2],o=[];for(let u=0;u<l.length;u+=1)o[u]=D(x(e,l,u));return{c(){n=c("h2"),t=i("Your Venues"),r=f(),s=c("div");for(let e=0;e<o.length;e+=1)o[e].c();this.h()},l(e){n=d(e,"H2",{});var l=m(n);t=p(l,"Your Venues"),l.forEach(g),r=E(e),s=d(e,"DIV",{id:!0});var u=m(s);for(let n=0;n<o.length;n+=1)o[n].l(u);u.forEach(g),this.h()},h(){$(s,"id","userVenues")},m(e,l){V(e,n,l),y(n,t),V(e,r,l),V(e,s,l);for(let n=0;n<o.length;n+=1)o[n].m(s,null)},p(e,n){if(4&n){let t;for(l=e[2],t=0;t<l.length;t+=1){const r=x(e,l,t);o[t]?o[t].p(r,n):(o[t]=D(r),o[t].c(),o[t].m(s,null))}for(;t<o.length;t+=1)o[t].d(1);o.length=l.length}},d(e){e&&g(n),e&&g(r),e&&g(s),I(o,e)}}}(e),C=e[3].length>0&&function(e){let n,t,r,s,l=e[3],o=[];for(let u=0;u<l.length;u+=1)o[u]=H(k(e,l,u));return{c(){n=c("h2"),t=i("All Venues"),r=f(),s=c("div");for(let e=0;e<o.length;e+=1)o[e].c();this.h()},l(e){n=d(e,"H2",{});var l=m(n);t=p(l,"All Venues"),l.forEach(g),r=E(e),s=d(e,"DIV",{id:!0});var u=m(s);for(let n=0;n<o.length;n+=1)o[n].l(u);u.forEach(g),this.h()},h(){$(s,"id","allVenues")},m(e,l){V(e,n,l),y(n,t),V(e,r,l),V(e,s,l);for(let n=0;n<o.length;n+=1)o[n].m(s,null)},p(e,n){if(8&n){let t;for(l=e[3],t=0;t<l.length;t+=1){const r=k(e,l,t);o[t]?o[t].p(r,n):(o[t]=H(r),o[t].c(),o[t].m(s,null))}for(;t<o.length;t+=1)o[t].d(1);o.length=l.length}},d(e){e&&g(n),e&&g(r),e&&g(s),I(o,e)}}}(e);return{c(){n=c("p"),t=i("Welcome "),r=i(w),s=f(),P&&P.c(),l=f(),o=c("div"),u=c("a"),a=i("Create A Venue Channel"),h=f(),C&&C.c(),j=v(),this.h()},l(e){n=d(e,"P",{});var c=m(n);t=p(c,"Welcome "),r=p(c,w),c.forEach(g),s=E(e),P&&P.l(e),l=E(e),o=d(e,"DIV",{id:!0,class:!0});var i=m(o);u=d(i,"A",{href:!0});var f=m(u);a=p(f,"Create A Venue Channel"),f.forEach(g),i.forEach(g),h=E(e),C&&C.l(e),j=v(),this.h()},h(){$(u,"href","/venues/create"),$(o,"id","newVenueButton"),$(o,"class","svelte-1trzo8z")},m(e,c){V(e,n,c),y(n,t),y(n,r),V(e,s,c),P&&P.m(e,c),V(e,l,c),V(e,o,c),y(o,u),y(u,a),V(e,h,c),C&&C.m(e,c),V(e,j,c)},p(e,n){1&n&&w!==(w=e[0].user.name+"")&&A(r,w),e[2].length>0&&P.p(e,n),e[3].length>0&&C.p(e,n)},d(e){e&&g(n),e&&g(s),P&&P.d(e),e&&g(l),e&&g(o),e&&g(h),C&&C.d(e),e&&g(j)}}}function D(e){let n,t,r,s,l=e[6].name+"";return{c(){n=c("p"),t=c("a"),r=i(l),s=f(),this.h()},l(e){n=d(e,"P",{});var o=m(n);t=d(o,"A",{href:!0});var u=m(t);r=p(u,l),u.forEach(g),s=E(o),o.forEach(g),this.h()},h(){$(t,"href",`venues/enter?venueId=${e[6].id}&route=${e[6].route}`)},m(e,l){V(e,n,l),y(n,t),y(t,r),y(n,s)},p:o,d(e){e&&g(n)}}}function H(e){let n,t,r,s,l=e[6].name+"";return{c(){n=c("p"),t=c("a"),r=i(l),s=f(),this.h()},l(e){n=d(e,"P",{});var o=m(n);t=d(o,"A",{href:!0});var u=m(t);r=p(u,l),u.forEach(g),s=E(o),o.forEach(g),this.h()},h(){$(t,"href",`/venues/join?venue=${e[6].id}`)},m(e,l){V(e,n,l),y(n,t),y(t,r),y(n,s)},p:o,d(e){e&&g(n)}}}function W(e){let n,t,v,$,A,j,I=e[1]&&function(e){let n,t;return n=new w({props:{message:e[1]}}),{c(){r(n.$$.fragment)},l(e){s(n.$$.fragment,e)},m(e,r){l(n,e,r),t=!0},p:o,i(e){t||(u(n.$$.fragment,e),t=!0)},o(e){a(n.$$.fragment,e),t=!1},d(e){h(n,e)}}}(e),P=e[0].user&&C(e);return{c(){n=c("h1"),t=i("Wine Pottle"),v=f(),I&&I.c(),$=f(),A=c("section"),P&&P.c()},l(e){n=d(e,"H1",{});var r=m(n);t=p(r,"Wine Pottle"),r.forEach(g),v=E(e),I&&I.l(e),$=E(e),A=d(e,"SECTION",{});var s=m(A);P&&P.l(s),s.forEach(g)},m(e,r){V(e,n,r),y(n,t),V(e,v,r),I&&I.m(e,r),V(e,$,r),V(e,A,r),P&&P.m(A,null),j=!0},p(e,[n]){e[1]&&I.p(e,n),e[0].user?P?P.p(e,n):(P=C(e),P.c(),P.m(A,null)):P&&(P.d(1),P=null)},i(e){j||(u(I),j=!0)},o(e){a(I),j=!1},d(e){e&&g(n),e&&g(v),I&&I.d(e),e&&g($),e&&g(A),P&&P.d()}}}var b=function(e,n,t,r){return new(t||(t=Promise))((function(s,l){function o(e){try{a(r.next(e))}catch(n){l(n)}}function u(e){try{a(r.throw(e))}catch(n){l(n)}}function a(e){var n;e.done?s(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,u)}a((r=r.apply(e,n||[])).next())}))};const z=({session:e,fetch:n})=>b(void 0,void 0,void 0,(function*(){if(!e.user)return{redirect:"login",status:302};e.venue&&(yield n("/venues/leave",{method:"post"}));try{const t=yield n(`venues.json?userId=${e.user.id}`),r=yield t.json();return{props:{venues:r.venues,uvms:r.userVenueMemberships}}}catch(t){console.log(t)}}));function N(e,n,t){let r;j(e,P,(e=>t(0,r=e)));let{venues:s}=n,{uvms:l}=n;const o=l.length>0?null==s?void 0:s.filter((e=>l.some((n=>(null==n?void 0:n.venueId)===e.id)))):[],u=o.length>0?null==s?void 0:s.filter((e=>!o.includes(e))):s;return e.$$set=e=>{"venues"in e&&t(4,s=e.venues),"uvms"in e&&t(5,l=e.uvms)},[r,undefined,o,u,s,l]}export default class extends e{constructor(e){super(),n(this,e,N,W,t,{venues:4,uvms:5})}}export{z as load};
