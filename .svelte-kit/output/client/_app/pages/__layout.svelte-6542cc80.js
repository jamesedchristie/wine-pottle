import{S as e,i as s,s as t,e as a,t as n,c as o,a as r,g as i,d as c,f as l,D as u,E as f,k as h,n as p,b as d,r as m,u as v,v as $,F as g,G as w,x as E,z as b,B as j,H as x,I as y,R as k,J as A,j as I,m as L,K as P,o as N,h as D,w as J,C as R}from"../chunks/vendor-4d4e9b60.js";import{g as B}from"../chunks/navigation-20968cc5.js";import{s as F}from"../chunks/stores-30b5dc7d.js";import{B as O}from"../chunks/Button-05365e81.js";import{l as S}from"../chunks/stores-e8816885.js";import"../chunks/singletons-bb9012b7.js";var K={apiKey:"AIzaSyACvhpAOwJSte81OElgRJtfFvYLxpu-F6s",authDomain:"winepottle.firebaseapp.com",projectId:"winepottle",storageBucket:"winepottle.appspot.com",messagingSenderId:"118092403337",appId:"1:118092403337:web:1cf5c3e510b9b19b91ac58",measurementId:"G-6KTPW3P72Y"};function V(e){let s,t;return{c(){s=a("p"),t=n("Loading...")},l(e){s=o(e,"P",{});var a=r(s);t=i(a,"Loading..."),a.forEach(c)},m(e,a){l(e,s,a),u(s,t)},d(e){e&&c(s)}}}function W(e){let s,t;return{c(){s=a("a"),t=n("Login"),this.h()},l(e){s=o(e,"A",{href:!0});var a=r(s);t=i(a,"Login"),a.forEach(c),this.h()},h(){d(s,"href","/login")},m(e,a){l(e,s,a),u(s,t)},p:A,i:A,o:A,d(e){e&&c(s)}}}function z(e){let s,t,f,v,g,w,E=e[0].user.name+"";return g=new O({props:{variant:"primary",$$slots:{default:[C]},$$scope:{ctx:e}}}),g.$on("click",e[2]),{c(){s=a("a"),t=n(E),v=h(),I(g.$$.fragment),this.h()},l(e){s=o(e,"A",{href:!0,style:!0});var a=r(s);t=i(a,E),a.forEach(c),v=p(e),L(g.$$.fragment,e),this.h()},h(){d(s,"href",f=`/profile/${e[0].user.name}`),P(s,"margin","0px 20px")},m(e,a){l(e,s,a),u(s,t),l(e,v,a),N(g,e,a),w=!0},p(e,a){(!w||1&a)&&E!==(E=e[0].user.name+"")&&D(t,E),(!w||1&a&&f!==(f=`/profile/${e[0].user.name}`))&&d(s,"href",f);const n={};16&a&&(n.$$scope={dirty:a,ctx:e}),g.$set(n)},i(e){w||($(g.$$.fragment,e),w=!0)},o(e){m(g.$$.fragment,e),w=!1},d(e){e&&c(s),e&&c(v),J(g,e)}}}function C(e){let s;return{c(){s=n("Logout")},l(e){s=i(e,"Logout")},m(e,t){l(e,s,t)},d(e){e&&c(s)}}}function G(e){let s,t,w,E,b,x,y,k,A,I,L,P,N,D,J,R,B,F=e[1]&&V();const O=[z,W],S=[];function K(e,s){return e[0].user?0:1}A=K(e),I=S[A]=O[A](e);const C=e[3].default,G=f(C,e,e[4],null);return{c(){s=a("header"),t=a("nav"),w=a("a"),E=n("Wine Pottle"),b=h(),x=a("div"),F&&F.c(),y=h(),k=a("div"),I.c(),L=h(),P=a("main"),G&&G.c(),N=h(),D=a("footer"),J=a("p"),R=n("© Jasmin Natterer 2021"),this.h()},l(e){s=o(e,"HEADER",{class:!0});var a=r(s);t=o(a,"NAV",{id:!0,class:!0});var n=r(t);w=o(n,"A",{id:!0,href:!0});var l=r(w);E=i(l,"Wine Pottle"),l.forEach(c),b=p(n),x=o(n,"DIV",{});var u=r(x);F&&F.l(u),u.forEach(c),y=p(n),k=o(n,"DIV",{id:!0});var f=r(k);I.l(f),f.forEach(c),n.forEach(c),a.forEach(c),L=p(e),P=o(e,"MAIN",{class:!0});var h=r(P);G&&G.l(h),h.forEach(c),N=p(e),D=o(e,"FOOTER",{class:!0});var d=r(D);J=o(d,"P",{});var m=r(J);R=i(m,"© Jasmin Natterer 2021"),m.forEach(c),d.forEach(c),this.h()},h(){d(w,"id","winePottleLogo"),d(w,"href","/"),d(k,"id","topNavRight"),d(t,"id","topNav"),d(t,"class","svelte-1nj3e00"),d(s,"class","svelte-1nj3e00"),d(P,"class","svelte-1nj3e00"),d(D,"class","svelte-1nj3e00")},m(e,a){l(e,s,a),u(s,t),u(t,w),u(w,E),u(t,b),u(t,x),F&&F.m(x,null),u(t,y),u(t,k),S[A].m(k,null),l(e,L,a),l(e,P,a),G&&G.m(P,null),l(e,N,a),l(e,D,a),u(D,J),u(J,R),B=!0},p(e,[s]){e[1]?F||(F=V(),F.c(),F.m(x,null)):F&&(F.d(1),F=null);let t=A;A=K(e),A===t?S[A].p(e,s):(j(),m(S[t],1,1,(()=>{S[t]=null})),v(),I=S[A],I?I.p(e,s):(I=S[A]=O[A](e),I.c()),$(I,1),I.m(k,null)),G&&G.p&&(!B||16&s)&&g(G,C,e,e[4],s,null,null)},i(e){B||($(I),$(G,e),B=!0)},o(e){m(I),m(G,e),B=!1},d(e){e&&c(s),F&&F.d(),S[A].d(),e&&c(L),e&&c(P),G&&G.d(e),e&&c(N),e&&c(D)}}}const H=({session:e,page:s})=>e.user||s.path.includes("login")?{props:{}}:{status:302,redirect:"/login"};function T(e,s,t){let a,n,o;w(e,F,(e=>t(0,n=e))),w(e,S,(e=>t(1,o=e)));let{$$slots:r={},$$scope:i}=s;var c=this&&this.__awaiter||function(e,s,t,a){return new(t||(t=Promise))((function(n,o){function r(e){try{c(a.next(e))}catch(s){o(s)}}function i(e){try{c(a.throw(e))}catch(s){o(s)}}function c(e){var s;e.done?n(e.value):(s=e.value,s instanceof t?s:new t((function(e){e(s)}))).then(r,i)}c((a=a.apply(e,s||[])).next())}))};let l=R({firebase:null,auth:null,firestore:null});return E("store",l),b((()=>c(void 0,void 0,void 0,(function*(){window.ssrUser=a;const e=window.firebase||x(K);window.firebase=e;const s=y(e),t=k(e);l.set({firebase:e,auth:s,firestore:t})})))),e.$$set=e=>{"$$scope"in e&&t(4,i=e.$$scope)},e.$$.update=()=>{1&e.$$.dirty&&(a=n.user||null)},[n,o,function(){return c(this,void 0,void 0,(function*(){yield fetch("/auth/logout",{method:"post"}),yield B("/logout")}))},r,i]}export default class extends e{constructor(e){super(),s(this,e,T,G,t,{})}}export{H as load};
