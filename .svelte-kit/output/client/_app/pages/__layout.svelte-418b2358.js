import{S as s,i as t,s as e,e as a,t as n,c as r,a as o,g as l,d as c,f as i,D as u,E as h,k as f,n as p,b as m,r as d,u as v,v as $,F as g,G as E,B as x,H as y,j as k,m as j,I as w,o as A,h as L,w as N}from"../chunks/vendor-197173f7.js";import{g as P}from"../chunks/navigation-20968cc5.js";import{s as b}from"../chunks/stores-23449eec.js";/* empty css                                                         *//* empty css                                                   */import{B as q}from"../chunks/Button-80d06a7e.js";import{l as D}from"../chunks/stores-6ec92c62.js";import"../chunks/singletons-bb9012b7.js";function I(s){let t,e;return{c(){t=a("p"),e=n("Loading...")},l(s){t=r(s,"P",{});var a=o(t);e=l(a,"Loading..."),a.forEach(c)},m(s,a){i(s,t,a),u(t,e)},d(s){s&&c(t)}}}function _(s){let t,e;return{c(){t=a("a"),e=n("Login"),this.h()},l(s){t=r(s,"A",{href:!0});var a=o(t);e=l(a,"Login"),a.forEach(c),this.h()},h(){m(t,"href","/login")},m(s,a){i(s,t,a),u(t,e)},p:y,i:y,o:y,d(s){s&&c(t)}}}function B(s){let t,e,h,v,g,E,x=s[1].user.name+"";return g=new q({props:{variant:"primary",$$slots:{default:[R]},$$scope:{ctx:s}}}),g.$on("click",s[2]),{c(){t=a("a"),e=n(x),v=f(),k(g.$$.fragment),this.h()},l(s){t=r(s,"A",{href:!0,style:!0});var a=o(t);e=l(a,x),a.forEach(c),v=p(s),j(g.$$.fragment,s),this.h()},h(){m(t,"href",h=`/profile/${s[1].user.name}`),w(t,"margin","0px 20px")},m(s,a){i(s,t,a),u(t,e),i(s,v,a),A(g,s,a),E=!0},p(s,a){(!E||2&a)&&x!==(x=s[1].user.name+"")&&L(e,x),(!E||2&a&&h!==(h=`/profile/${s[1].user.name}`))&&m(t,"href",h);const n={};16&a&&(n.$$scope={dirty:a,ctx:s}),g.$set(n)},i(s){E||($(g.$$.fragment,s),E=!0)},o(s){d(g.$$.fragment,s),E=!1},d(s){s&&c(t),s&&c(v),N(g,s)}}}function R(s){let t;return{c(){t=n("Logout")},l(s){t=l(s,"Logout")},m(s,e){i(s,t,e)},d(s){s&&c(t)}}}function V(s){let t,e,E,y,k,j,w,A,L,N,P,b,q,D,R,V,F,H=s[0]&&I();const J=[B,_],O=[];function W(s,t){return s[1].user?0:1}L=W(s),N=O[L]=J[L](s);const C=s[3].default,G=h(C,s,s[4],null);return{c(){t=a("header"),e=a("nav"),E=a("a"),y=n("Wine Pottle"),k=f(),j=a("div"),H&&H.c(),w=f(),A=a("div"),N.c(),P=f(),b=a("main"),G&&G.c(),q=f(),D=a("footer"),R=a("p"),V=n("© Jasmin Natterer 2021"),this.h()},l(s){t=r(s,"HEADER",{class:!0});var a=o(t);e=r(a,"NAV",{id:!0,class:!0});var n=o(e);E=r(n,"A",{id:!0,href:!0});var i=o(E);y=l(i,"Wine Pottle"),i.forEach(c),k=p(n),j=r(n,"DIV",{});var u=o(j);H&&H.l(u),u.forEach(c),w=p(n),A=r(n,"DIV",{id:!0});var h=o(A);N.l(h),h.forEach(c),n.forEach(c),a.forEach(c),P=p(s),b=r(s,"MAIN",{class:!0});var f=o(b);G&&G.l(f),f.forEach(c),q=p(s),D=r(s,"FOOTER",{class:!0});var m=o(D);R=r(m,"P",{});var d=o(R);V=l(d,"© Jasmin Natterer 2021"),d.forEach(c),m.forEach(c),this.h()},h(){m(E,"id","winePottleLogo"),m(E,"href","/"),m(A,"id","topNavRight"),m(e,"id","topNav"),m(e,"class","svelte-158lxlq"),m(t,"class","svelte-158lxlq"),m(b,"class","svelte-158lxlq"),m(D,"class","svelte-158lxlq")},m(s,a){i(s,t,a),u(t,e),u(e,E),u(E,y),u(e,k),u(e,j),H&&H.m(j,null),u(e,w),u(e,A),O[L].m(A,null),i(s,P,a),i(s,b,a),G&&G.m(b,null),i(s,q,a),i(s,D,a),u(D,R),u(R,V),F=!0},p(s,[t]){s[0]?H||(H=I(),H.c(),H.m(j,null)):H&&(H.d(1),H=null);let e=L;L=W(s),L===e?O[L].p(s,t):(x(),d(O[e],1,1,(()=>{O[e]=null})),v(),N=O[L],N?N.p(s,t):(N=O[L]=J[L](s),N.c()),$(N,1),N.m(A,null)),G&&G.p&&(!F||16&t)&&g(G,C,s,s[4],t,null,null)},i(s){F||($(N),$(G,s),F=!0)},o(s){d(N),d(G,s),F=!1},d(s){s&&c(t),H&&H.d(),O[L].d(),s&&c(P),s&&c(b),G&&G.d(s),s&&c(q),s&&c(D)}}}const F=({session:s,page:t})=>s.user||t.path.includes("login")?{props:{}}:{status:302,redirect:"/login"};function H(s,t,e){let a,n;E(s,D,(s=>e(0,a=s))),E(s,b,(s=>e(1,n=s)));let{$$slots:r={},$$scope:o}=t;var l=this&&this.__awaiter||function(s,t,e,a){return new(e||(e=Promise))((function(n,r){function o(s){try{c(a.next(s))}catch(t){r(t)}}function l(s){try{c(a.throw(s))}catch(t){r(t)}}function c(s){var t;s.done?n(s.value):(t=s.value,t instanceof e?t:new e((function(s){s(t)}))).then(o,l)}c((a=a.apply(s,t||[])).next())}))};return s.$$set=s=>{"$$scope"in s&&e(4,o=s.$$scope)},[a,n,function(){return l(this,void 0,void 0,(function*(){yield fetch("/auth/logout",{method:"post"}),P("/logout")}))},r,o]}export default class extends s{constructor(s){super(),t(this,s,H,V,e,{})}}export{F as load};
